<!DOCTYPE html>
<html>

	<head lang="en">
		<meta charset="UTF-8">
		<script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
		<title></title>
	</head>
	<style type="text/css">
		html,body{
			margin: 0;
			padding: 0;
			height: 100%;
			position: relative;
		}
		body::after{
			content: "";
			width: 1px;
			height: 100%;
			position: absolute;
			left: 50%;
			top: 0;
			transform: translateX(-50%);
			background: red;
		}
		.test {
			height: 100px;
			width: 100px;
			position: fixed;
			top: 0;
			left: 0;
			background: red;
		}
		
	</style>

	<body>
		<div class="test"></div>
	</body>
	<script type="text/javascript">
		
		var hh = $('.test');
		
		var test = function(obj){
			// 点击拖拽的按钮
			obj.on('touchstart', function(e) {
				obj.css('transition', 'none');
				// 记录点击的点
				var touches = e.originalEvent.targetTouches[0];
				var touch_start_x = touches.clientX;
				var touch_start_y = touches.clientY;

				console.log(touch_start_y)
				// 记录球的位置
				var oBox_x = parseInt($(this).css('left'));
				var oBox_y = parseInt($(this).css('top'));

				// 相减后的坐标
				var move_x = touch_start_x - oBox_x;
				var move_y = touch_start_y - oBox_y;

				// 移动
				var end_x = touch_start_x;
				var end_y = touch_start_y;

				// 屏幕宽度(可见)
				var win_width = $(window).width();
				var win_height = $(window).height();

				// 小球宽高
				var oBox_h = $(this).height();
				var oBox_w = $(this).width();

				obj.on('touchmove', function(e) {
					//阻止页面的滑动默认事件
					e.preventDefault();
					//记录点击时的坐标点
					var touches = e.originalEvent.targetTouches[0];
					var touch_move_x = touches.clientX;
					var touch_move_y = touches.clientY;

					// 最终位置的点
					end_x = touch_move_x - move_x;
					end_y = touch_move_y - move_y;
					//获取header的高度
					var headerH = 0;

					if((touch_move_x - move_x) >= (win_width - oBox_w)) {
						end_x = win_width - oBox_w;
					}
					if((touch_move_x - move_x) <= 0) {
						end_x = 0;
					}
					if((touch_move_y - move_y) >= (win_height - oBox_h - 0)) {
						end_y = win_height - oBox_h - 0;
					}
					if((touch_move_y - move_y) <= headerH) {
						end_y = headerH;
					}

					$(this).css({
						'top': end_y + 'px',
						'left': end_x + 'px'
					})
				})

				// 松开
				obj.on('touchend', function(e) {
					// $('html,body').css('overflow','auto');

					obj.css('transition', 'all 0.5s');
					obj.off('touchmove');
					obj.off('touchend');

					if((end_x+(obj.width()/2)) > win_width / 2) {
						end_x = win_width - oBox_w;
					} else {
						end_x = 0;
					}
					obj.css('left', end_x);
				})

			})
		}
		
		test(hh)
	</script>

</html>